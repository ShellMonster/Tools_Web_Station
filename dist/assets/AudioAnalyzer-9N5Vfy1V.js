import{r as s,j as r}from"./vendor-E1qkQgBK.js";import{T as R}from"./ToolSection-D3WFVMtC.js";import{u as j}from"./index-T0krPfu9.js";import"./format-parsers-Cy82sy8R.js";import"./mermaid-qV9g4jTJ.js";const N=()=>{const[o,y]=s.useState(""),d=s.useRef(null),u=s.useRef(null),f=s.useRef(null),g=s.useRef(null),{t:w}=j();return s.useEffect(()=>{if(!o||!d.current)return;const n=new(window.AudioContext||window.webkitAudioContext),a=n.createMediaElementSource(d.current),e=n.createAnalyser();e.fftSize=256,a.connect(e),e.connect(n.destination),g.current=e;const t=u.current,i=t.getContext("2d"),c=e.frequencyBinCount,m=new Uint8Array(c),h=()=>{e.getByteFrequencyData(m),i.fillStyle="#0f172a",i.fillRect(0,0,t.width,t.height);const x=t.width/c*2.5;let p=0;for(let l=0;l<c;l+=1){const b=m[l];i.fillStyle=`hsl(${l/c*180+200}, 80%, 60%)`,i.fillRect(p,t.height-b,x,b),p+=x+1}f.current=requestAnimationFrame(h)};return h(),()=>{cancelAnimationFrame(f.current),e.disconnect(),a.disconnect(),n.close()}},[o]),r.jsxs(R,{title:"音频频率分析",description:"上传音频文件，实时查看频谱变化。",children:[r.jsxs("label",{className:"inline-flex cursor-pointer items-center gap-2 rounded-lg border border-dashed border-slate-300 bg-white px-4 py-3 text-sm text-slate-600 shadow-sm transition hover:border-primary hover:text-primary dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 dark:hover:border-primary/80",children:[r.jsxs("span",{children:["📁 ",w("选择音频文件")]}),r.jsx("input",{type:"file",accept:"audio/*",onChange:n=>{var t;const a=(t=n.target.files)==null?void 0:t[0];if(!a)return;const e=URL.createObjectURL(a);y(e)},className:"hidden"})]}),o?r.jsxs("div",{className:"mt-4 space-y-3",children:[r.jsx("audio",{ref:d,src:o,controls:!0,className:"w-full"}),r.jsx("canvas",{ref:u,width:640,height:220,className:"w-full rounded-lg border border-slate-200 bg-slate-900 dark:border-slate-800"})]}):null]})};export{N as default};
