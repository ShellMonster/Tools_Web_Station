import{r as s}from"./index-DwkGyXRE.js";const i=typeof window!="undefined",g=e=>{if(!i)return null;try{return window.localStorage.getItem(e)}catch(r){return console.warn("[usePersistentState] Failed to read storage",r),null}},u=(e,r)=>{if(i)try{window.localStorage.setItem(e,JSON.stringify(r))}catch(o){console.warn("[usePersistentState] Failed to write storage",o)}},m=(e,r)=>{const o=s.useRef(r),l=s.useCallback(()=>{const t=o.current,n=typeof t=="function"?t():t,a=g(e);if(a==null)return n;try{return JSON.parse(a)}catch(w){return console.warn("[usePersistentState] Failed to parse storage",w),n}},[e]),[f,c]=s.useState(l);s.useMemo(()=>{o.current=r},[r]);const S=s.useCallback(t=>{c(n=>{const a=typeof t=="function"?t(n):t;return u(e,a),a})},[e]),d=s.useCallback(()=>{const t=o.current,n=typeof t=="function"?t():t;u(e,n),c(n)},[e]);return[f,S,d]};export{m as u};
