import{r as s,j as e,i as k}from"./vendor-E1qkQgBK.js";import{T as v}from"./ToolSection-D3WFVMtC.js";import{u as w}from"./index-T0krPfu9.js";import"./format-parsers-Cy82sy8R.js";import"./mermaid-qV9g4jTJ.js";const L=()=>{const[n,g]=s.useState(.7),[m,h]=s.useState(null),[d,f]=s.useState(null),[i,b]=s.useState({original:"",compressed:""}),[l,c]=s.useState(!1),[x,p]=s.useState(""),{t}=w(),j=async o=>{var u;const r=(u=o.target.files)==null?void 0:u[0];if(r){c(!0);try{h({name:r.name,size:r.size});const a=await k(r,{maxSizeMB:n,maxWidthOrHeight:1920,useWebWorker:!0});f({name:a.name,size:a.size});const y=URL.createObjectURL(r),N=URL.createObjectURL(a);b({original:y,compressed:N}),p("")}catch(a){p(`压缩失败: ${a.message}`)}finally{c(!1)}}};return e.jsxs(v,{title:"图片压缩",description:"在浏览器内压缩图片，支持调整目标大小。",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center",children:[e.jsxs("label",{className:`inline-flex cursor-pointer items-center gap-2 rounded-lg border border-dashed border-slate-300 bg-white px-4 py-3 text-sm text-slate-600 shadow-sm transition hover:border-primary hover:text-primary dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 dark:hover:border-primary/80 ${l?"opacity-60":""}`,children:[e.jsxs("span",{children:["📁 ",t(l?"处理中…":"选择图片")]}),e.jsx("input",{type:"file",accept:"image/*",onChange:j,disabled:l,className:"hidden"})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm text-slate-500 dark:text-slate-300",children:[t("目标大小 (MB)"),e.jsx("input",{type:"number",min:.2,max:5,step:.1,value:n,onChange:o=>g(Number(o.target.value)),className:"w-24 rounded-md border border-slate-200 bg-white px-2 py-1 text-sm focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20 dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200"})]})]}),x?e.jsx("p",{className:"mt-2 text-sm text-red-500",children:x}):null,e.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[i.original?e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:t("原始")}),e.jsxs("p",{className:"text-xs text-slate-500",children:[m.name," · ",(m.size/1024).toFixed(1)," KB"]}),e.jsx("img",{src:i.original,alt:"original",className:"mt-2 max-h-64 rounded-lg object-contain"})]}):null,i.compressed?e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-slate-600 dark:text-slate-300",children:t("压缩后")}),e.jsxs("p",{className:"text-xs text-slate-500",children:[d.name," · ",(d.size/1024).toFixed(1)," KB"]}),e.jsx("img",{src:i.compressed,alt:"compressed",className:"mt-2 max-h-64 rounded-lg object-contain"})]}):null]})]})};export{L as default};
