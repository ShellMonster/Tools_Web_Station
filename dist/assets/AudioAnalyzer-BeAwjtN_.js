import{r as s,u as R,j as r}from"./index-DwkGyXRE.js";import{T as j}from"./ToolSection-DOJU4p5W.js";const k=()=>{const[o,y]=s.useState(""),d=s.useRef(null),u=s.useRef(null),f=s.useRef(null),g=s.useRef(null),{t:w}=R();return s.useEffect(()=>{if(!o||!d.current)return;const n=new(window.AudioContext||window.webkitAudioContext),a=n.createMediaElementSource(d.current),e=n.createAnalyser();e.fftSize=256,a.connect(e),e.connect(n.destination),g.current=e;const t=u.current,c=t.getContext("2d"),i=e.frequencyBinCount,h=new Uint8Array(i),m=()=>{e.getByteFrequencyData(h),c.fillStyle="#0f172a",c.fillRect(0,0,t.width,t.height);const x=t.width/i*2.5;let b=0;for(let l=0;l<i;l+=1){const p=h[l];c.fillStyle=`hsl(${l/i*180+200}, 80%, 60%)`,c.fillRect(b,t.height-p,x,p),b+=x+1}f.current=requestAnimationFrame(m)};return m(),()=>{cancelAnimationFrame(f.current),e.disconnect(),a.disconnect(),n.close()}},[o]),r.jsxs(j,{title:"音频频率分析",description:"上传音频文件，实时查看频谱变化。",children:[r.jsxs("label",{className:"inline-flex cursor-pointer items-center gap-2 rounded-lg border border-dashed border-slate-300 bg-white px-4 py-3 text-sm text-slate-600 shadow-sm transition hover:border-primary hover:text-primary dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 dark:hover:border-primary/80",children:[r.jsxs("span",{children:["📁 ",w("选择音频文件")]}),r.jsx("input",{type:"file",accept:"audio/*",onChange:n=>{var t;const a=(t=n.target.files)==null?void 0:t[0];if(!a)return;const e=URL.createObjectURL(a);y(e)},className:"hidden"})]}),o?r.jsxs("div",{className:"mt-4 space-y-3",children:[r.jsx("audio",{ref:d,src:o,controls:!0,className:"w-full"}),r.jsx("canvas",{ref:u,width:640,height:220,className:"w-full rounded-lg border border-slate-200 bg-slate-900 dark:border-slate-800"})]}):null]})};export{k as default};
