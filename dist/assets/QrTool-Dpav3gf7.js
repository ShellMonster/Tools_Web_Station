import{r as d,j as e}from"./vendor-E1qkQgBK.js";import{B as b}from"./Button-S8-yJkDU.js";import{I as y}from"./Input-dBmVsq4B.js";import{T as j}from"./ToolSection-D3WFVMtC.js";import{c as N}from"./clipboard-4Xj0hnU0.js";import{Q as C,j as R}from"./qr-tools-BDKnGZWC.js";import{u as D}from"./index-T0krPfu9.js";import"./format-parsers-Cy82sy8R.js";import"./mermaid-qV9g4jTJ.js";const U=()=>{const[l,v]=d.useState("https://example.com"),[m,x]=d.useState(""),[p,i]=d.useState(""),h=d.useRef(null),{t:o}=D(),w=()=>{var r;const t=(r=h.current)==null?void 0:r.querySelector("canvas");if(!t)return;const a=document.createElement("a");a.href=t.toDataURL("image/png"),a.download="qrcode.png",a.click()},k=async t=>{var g;const a=(g=t.target.files)==null?void 0:g[0];if(!a)return;const r=new FileReader;r.onload=()=>{const s=new Image;s.onload=()=>{const n=document.createElement("canvas");n.width=s.width,n.height=s.height;const u=n.getContext("2d");u.drawImage(s,0,0);const c=u.getImageData(0,0,n.width,n.height),f=R(c.data,c.width,c.height);f?(x(f.data),i("")):(x(""),i(o("未识别到二维码")))},s.onerror=()=>{i(o("图片加载失败"))},s.src=r.result},r.readAsDataURL(a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx(j,{title:"二维码生成",description:"输入文本生成二维码，支持下载。",actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(b,{onClick:w,children:o("下载 PNG")}),e.jsx(b,{variant:"secondary",onClick:()=>N(l),children:o("复制文本")})]}),children:e.jsxs("div",{className:"flex flex-col items-start gap-4 md:flex-row md:items-center",children:[e.jsx("div",{ref:h,className:"rounded-xl border border-slate-200 bg-white p-4 dark:border-slate-800 dark:bg-slate-900",children:e.jsx(C,{value:l||"",size:180,level:"M",includeMargin:!0})}),e.jsx(y,{value:l,onChange:t=>v(t.target.value),className:"md:w-80"})]})}),e.jsxs(j,{title:"二维码解码",description:"上传图片识别二维码内容。",children:[e.jsxs("label",{className:"inline-flex cursor-pointer items-center gap-2 rounded-lg border border-dashed border-slate-300 bg-white px-4 py-3 text-sm text-slate-600 shadow-sm transition hover:border-primary hover:text-primary dark:border-slate-700 dark:bg-slate-900 dark:text-slate-200 dark:hover:border-primary/80",children:[e.jsxs("span",{children:["📁 ",o("选择二维码图片")]}),e.jsx("input",{type:"file",accept:"image/*",onChange:k,className:"hidden"})]}),m?e.jsx("div",{className:"mt-3 rounded-lg border border-slate-200 bg-slate-50 px-4 py-3 text-sm font-mono text-slate-600 dark:border-slate-800 dark:bg-slate-900 dark:text-slate-200",children:m}):null,p?e.jsx("p",{className:"mt-2 text-sm text-red-500",children:p}):null]})]})};export{U as default};
